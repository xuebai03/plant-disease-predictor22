<!DOCTYPE html>
<html>
<head>
    <title>农业预测模型</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>农业高召回率预测模型</h1>
        <form id="prediction-form">
            <div class="form-group">
                <label for="temperature">温度 (°C):</label>
                <input type="number" step="0.1" id="temperature" name="temperature" required>
            </div>
            
            <div class="form-group">
                <label for="humidity">湿度 (%):</label>
                <input type="number" step="0.1" id="humidity" name="humidity" required>
            </div>
            
            <div class="form-group">
                <label for="rainfall">降雨量 (mm):</label>
                <input type="number" step="0.1" id="rainfall" name="rainfall" required>
            </div>
            
            <div class="form-group">
                <label for="soil_ph">土壤 pH:</label>
                <input type="number" step="0.1" id="soil_ph" name="soil_ph" required>
            </div>
            
            <button type="submit">预测</button>
        </form>
        
        <div id="result" style="display: none;">
            <h3>预测结果</h3>
            <p id="prediction-text"></p>
            <p id="probability-text"></p>
        </div>
        
        <div id="error" style="display: none; color: red;">
            <h3>错误</h3>
            <p id="error-message"></p>
        </div>
    </div>

    <script>
        document.getElementById('prediction-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                temperature: document.getElementById('temperature').value,
                humidity: document.getElementById('humidity').value,
                rainfall: document.getElementById('rainfall').value,
                soil_ph: document.getElementById('soil_ph').value
            };
            
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.error) {
                    document.getElementById('error-message').textContent = result.error;
                    document.getElementById('error').style.display = 'block';
                    document.getElementById('result').style.display = 'none';
                } else {
                    const predictionText = result.prediction === 1 ? '正类' : '负类';
                    document.getElementById('prediction-text').textContent = `预测类别: ${predictionText}`;
                    document.getElementById('probability-text').textContent = `正类概率: ${(result.probability * 100).toFixed(2)}%`;
                    document.getElementById('result').style.display = 'block';
                    document.getElementById('error').style.display = 'none';
                }
            } catch (error) {
                document.getElementById('error-message').textContent = '网络错误: ' + error.message;
                document.getElementById('error').style.display = 'block';
                document.getElementById('result').style.display = 'none';
            }
        });
    </script>
</body>
</html>